<form
	[formGroup]="todoForm"
	(ngSubmit)="addTodo()"
	class="prose flex flex-col gap-3 items-center"
>
	<div class="flex flex-col gap-2">
		<h1 class="text-center my-0">Todo maker:</h1>
		<p class="my-0 max-w-[42ch]">
			Create todos in a few clicks and save them in the cloud (only if
			you're logged in your account). Manage todos and enjoy the power of
			web!
		</p>
	</div>
	<ui-input
		placeholder="Todo title"
		inputFormControlName="title"
		id="todoTitle"
		title="Title"
	></ui-input>

	<ui-button type="submit" [disabledCondition]="!todoForm.valid">
		<ng-template #content>Add todo!</ng-template>
	</ui-button>

	<div class="flex flex-col mt-5 gap-2">
		<h1 class="text-center my-0">Todos list:</h1>
		<p class="my-0 max-w-[42ch]">
			Lists your current Todos (if possible, synced with the cloud) and
			allows to manage them.
		</p>
	</div>
	<form>
		<ul class="flex flex-col">
			<ng-container *ngIf="todos$ | async as todosSync">
				<ng-container *ngIf="todosSync.uncompleted.length !== 0">
					<h2 class="text-center my-0">Uncompleted todos:</h2>
					<li class="my-4" *ngFor="let todo of todosSync.uncompleted">
						<div
							class="group relative flex flex-row-reverse gap-2 justify-center items-center"
						>
							<span
								class="with-hover:hidden with-hover:absolute group-hover:flex touch:flex items-center justify-center p-2.5 border border-neutral-300 rounded-lg bg-gray-50 hover:bg-gray-100 active:bg-gray-200 top-1 right-1 cursor-pointer transition-all w-fit h-fit"
								(click)="removeTodo(todo.id!)"
							>
								<svg
									xmlns="http://www.w3.org/2000/svg"
									viewBox="0 0 448 512"
									class="w-4 h-4 fill-neutral-500"
								>
									<path
										d="M135.2 17.69C140.6 6.848 151.7 0 163.8 0H284.2C296.3 0 307.4 6.848 312.8 17.69L320 32H416C433.7 32 448 46.33 448 64C448 81.67 433.7 96 416 96H32C14.33 96 0 81.67 0 64C0 46.33 14.33 32 32 32H128L135.2 17.69zM394.8 466.1C393.2 492.3 372.3 512 346.9 512H101.1C75.75 512 54.77 492.3 53.19 466.1L31.1 128H416L394.8 466.1z"
									/>
								</svg>
							</span>
							<div class="flex flex-col gap-1 w-full">
								<h3 class="my-0">{{ todo.title }}</h3>
								<label class="flex gap-2 my-0">
									Completed:
									<input
										type="checkbox"
										[checked]="todo.completed"
										class="rounded-lg shadow border border-neutral-300"
										(click)="
											toggleTodoComplete(
												todo,
												self.checked
											)
										"
										#self
									/>
								</label>
							</div>
						</div>
					</li>
				</ng-container>

				<ng-container *ngIf="todosSync.completed.length !== 0">
					<h2 class="text-center my-0">Completed todos:</h2>
					<li class="my-4" *ngFor="let todo of todosSync.completed">
						<div
							class="group relative flex flex-row-reverse gap-2 justify-center items-center"
						>
							<span
								class="with-hover:hidden with-hover:absolute group-hover:flex touch:flex items-center justify-center p-2.5 border border-neutral-300 rounded-lg bg-gray-50 hover:bg-gray-100 active:bg-gray-200 top-1 right-1 cursor-pointer transition-all w-fit h-fit"
								(click)="removeTodo(todo.id!)"
							>
								<svg
									xmlns="http://www.w3.org/2000/svg"
									viewBox="0 0 448 512"
									class="w-4 h-4 fill-neutral-500"
								>
									<path
										d="M135.2 17.69C140.6 6.848 151.7 0 163.8 0H284.2C296.3 0 307.4 6.848 312.8 17.69L320 32H416C433.7 32 448 46.33 448 64C448 81.67 433.7 96 416 96H32C14.33 96 0 81.67 0 64C0 46.33 14.33 32 32 32H128L135.2 17.69zM394.8 466.1C393.2 492.3 372.3 512 346.9 512H101.1C75.75 512 54.77 492.3 53.19 466.1L31.1 128H416L394.8 466.1z"
									/>
								</svg>
							</span>
							<div class="flex flex-col gap-1 w-full">
								<h3 class="my-0 line-through">
									{{ todo.title }}
								</h3>
								<label class="flex gap-2 my-0">
									Completed:
									<input
										type="checkbox"
										[checked]="todo.completed"
										class="rounded-lg shadow border border-neutral-300"
										(click)="
											toggleTodoComplete(
												todo,
												self.checked
											)
										"
										#self
									/>
								</label>
							</div>
						</div>
					</li>
				</ng-container>
			</ng-container>
		</ul>
	</form>
</form>
